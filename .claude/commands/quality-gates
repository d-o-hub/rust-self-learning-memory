#!/bin/bash
# Quality Gates Command for Claude Code
# Run full quality checks before commits or CI verification

echo "=== Quality Gates ==="

echo "[1/4] Formatting check..."
if ! cargo fmt --all -- --check 2>/dev/null; then
    echo "FAIL: fmt"
    echo "Fix: cargo fmt --all"
    exit 1
fi

echo "[2/4] Clippy linting..."
if ! cargo clippy --all -- -D warnings 2>/dev/null; then
    echo "FAIL: clippy"
    echo "Fix: cargo clippy --fix or add allow-rules"
    exit 1
fi

echo "[3/4] Building..."
if ! cargo build --all 2>/dev/null; then
    echo "FAIL: build"
    echo "Fix: Check compilation errors above"
    exit 1
fi

echo "[4/4] Testing..."
if ! cargo test --all 2>/dev/null; then
    echo "FAIL: tests"
    echo "Fix: Check test failures above"
    exit 1
fi

echo "=== All Gates Passed ==="
